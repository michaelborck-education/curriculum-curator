# Backend Code Status

> **Purpose**: Track which backend code is actively used vs. orphaned/placeholder.
> This helps identify dead code to remove once UI/UX is finalized.
>
> **Last Updated**: 2024-11-29

## Strategy

We're taking a **UI/UX first approach**:
1. Design and test the frontend user experience
2. Backend API contracts become clear from UI needs
3. Remove/refactor unused backend code
4. Keep orphaned code for now as it may provide ideas/patterns

---

## API Routes Status

### ✅ Active Routes (registered in main.py)

| Prefix | File | Purpose |
|--------|------|---------|
| `/api/auth` | `auth.py` | Authentication, registration, password reset |
| `/api/admin` | `admin.py` | User management, whitelist |
| `/api/admin-config` | `admin_config.py` | System configuration |
| `/api/ai` | `ai.py` | **Unified LLM endpoint** - generation, enhancement, pedagogy |
| `/api/analytics` | `analytics.py` | Usage analytics |
| `/api/assessments` | `assessments.py` | Assessment CRUD |
| `/api/content` | `content.py` | Content management |
| `/api/llm-config` | `llm_config.py` | LLM provider configuration |
| `/api/materials` | `materials.py` | Learning materials |
| `/api/monitoring` | `monitoring.py` | System health checks |
| `/api/outcomes` | `learning_outcomes.py` | ULOs and CLOs |
| `/api/units` | `units.py` | Unit (subject) management |
| `/api/user` | `user_export.py` | User data export |

### ⚠️ Routes Registered but Uncertain Usage

| Prefix | File | Notes |
|--------|------|-------|
| `/api/content/workflow` | `content_workflow.py` | Wizard for 12-week skeleton - may be replaced |
| `/api/unit-structure` | `unit_structure.py` | Part of wizard system |
| `/api/content/import` | `import_content.py` | PDF import - needs testing |
| `/api/content/versions` | `content_versions.py` | Version control - needs UI |
| `/api/content/export` | `content_export.py` | Export to various formats |

---

## Services Status

### ✅ Actively Used (imported by routes)

| Service | Used By | Purpose |
|---------|---------|---------|
| `llm_service` | `ai.py`, `llm_config.py` | Core LLM functionality |
| `email_service` | `auth.py` | Email verification |
| `analytics_service` | `analytics.py` | Usage tracking |
| `assessments_service` | `assessments.py` | Assessment logic |
| `materials_service` | `materials.py` | Materials management |
| `ulo_service` | `learning_outcomes.py` | Learning outcomes |
| `security_logger` | `admin.py`, `auth.py` | Security event logging |
| `file_import_service` | `content.py`, `import_content.py` | File processing |
| `pdf_parser_service` | `import_content.py` | PDF extraction |
| `quarto_service` | `content_export.py` | Document rendering |

### ⚠️ Partially Used / Uncertain

| Service | Notes |
|---------|-------|
| `content_workflow_service` | Powers the wizard - may be replaced |
| `workflow_structure_creator` | Creates structures from wizard - may be replaced |
| `document_analyzer_service` | PDF analysis - large file, needs review |
| `git_content_service` | Only initialized in main.py, not used by routes |

### ❌ Orphaned (not imported by any route)

| Service | Lines | Notes |
|---------|-------|-------|
| `config_service` | 257 | System config - may be needed for admin UI |
| `prompt_template_service` | 294 | **Good code** - needs API routes to expose |
| `prompt_templates` | 415 | In-memory templates - used by prompt_template_service |

---

## Models Status

### ✅ Actively Used

- `User`, `Unit`, `Content`, `Assessment`
- `EmailWhitelist`, `EmailVerification`, `PasswordReset`
- `LoginAttempt`, `SecurityLog`
- `SystemSettings`, `SystemConfig`
- `LLMConfiguration`, `ContentVersion`
- `WeeklyMaterial`, `WorkflowChatSession`

### ⚠️ Partially Used / Part of Wizard

| Model | Notes |
|-------|-------|
| `UnitOutline` | Created by wizard |
| `WeeklyTopic` | Part of unit structure |
| `AssessmentPlan` | Generated by wizard |
| `GenerationHistory` | LLM usage tracking |
| `ChatSession`, `Chat` | Workflow conversations |

### ❌ Orphaned / Placeholder

| Model | Lines | Notes |
|-------|-------|-------|
| `LRD` | ~50 | Learning Resource Document - no routes |
| `TaskList` | ~60 | Task tracking for LRD - no routes |
| `PromptTemplate` | ~120 | **Good model** - needs routes |
| `QuartoPreset` | ~40 | Rendering presets - no routes |
| `QuizQuestion` | ~90 | Quiz system - no routes |
| `ValidationResult` | ~70 | Content validation - no routes |
| `Material` | ~70 | Relationships exist, unclear usage |

---

## Plugins Status

**All plugins are placeholder code** (~3,400 lines total)

| Plugin | Purpose | Status |
|--------|---------|--------|
| `plugin_manager.py` | Plugin orchestration | Not wired up |
| `spell_checker.py` | Spell checking | Not wired up |
| `grammar_validator.py` | Grammar checking | Not wired up |
| `readability_validator.py` | Reading level analysis | Not wired up |
| `accessibility_validator.py` | Accessibility checks | Not wired up |
| `inclusive_language_validator.py` | Language checking | Not wired up |
| `code_formatter.py` | Code block formatting | Not wired up |
| `toc_generator.py` | Table of contents | Not wired up |
| `url_verifier.py` | Link checking | Not wired up |
| `basic_remediator.py` | Content fixes | Not wired up |

**Decision**: Keep for future LLM post-processing. Will need integration point.

---

## Schemas Status

### Potentially Orphaned Schemas

| Schema File | Notes |
|-------------|-------|
| `course_structure.py` | Used by import_content.py |
| `course_module.py` | May be orphaned |
| `lrd.py` | No routes use it |
| `task.py` | No routes use it |

---

## Recommendations

### Keep (valuable, just needs wiring)
1. **Prompt Template System** - Good design, needs API routes
2. **Plugin System** - Valuable for LLM post-processing
3. **Git Content Service** - Good for version control if needed

### Review When UI/UX Stable
1. **Workflow/Wizard code** - May replace entirely based on UI
2. **Document Analyzer** - Large, complex, may simplify
3. **LRD/TaskList models** - Decide if feature is needed

### Safe to Remove (if not needed after UI)
1. Orphaned schemas without routes
2. Models with no relationships or usage
3. Any service not called by final routes

---

## How to Update This Document

After UI/UX work, run these commands to check status:

```bash
# Find unused imports in routes
rg "^from app.services" app/api/routes/*.py | sed 's/.*import //' | sort -u

# Find services never imported
for f in app/services/*.py; do
  name=$(basename $f .py)
  if ! rg -q "from app.services.*$name|from app.services import.*$name" app/api/; then
    echo "UNUSED: $name"
  fi
done

# Find models never imported by routes
for f in app/models/*.py; do
  name=$(basename $f .py)
  if ! rg -q "from app.models.*$name|from app.models import.*$name" app/api/; then
    echo "UNUSED: $name"
  fi
done
```
